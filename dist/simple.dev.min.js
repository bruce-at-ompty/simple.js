!function(global){"use strict";global.SimpleEvent={eventCache:{},listen:function(e,t){this.eventCache[e]=this.eventCache[e]||[],this.eventCache[e].push(t)},emit:function(e,t){if(this.eventCache[e]&&this.eventCache[e].length>0)for(var h in this.eventCache[e]){var n=this.eventCache[e][h];try{n(t)}catch(c){console.log("Error",c)}}}},"undefined"!=typeof exports&&(exports.SimpleEvent=global.SimpleEvent)}(this),function(global){"use strict";String.prototype.hashCode=function(){var i,chr,len,hash=0;if(0===this.length)return hash;for(i=0,len=this.length;len>i;i++)chr=this.charCodeAt(i),hash=(hash<<5)-hash+chr,hash|=0;return hash};var app=function(name,config){name=JSON.stringify(name).hashCode();var prefix="__ss_app_"+name;if(this.name=name,global[prefix]=this,this.localStorageKey=prefix+"_data",this.container=null,this.state={},this.previousState={},this.config={shouldSaveStateToLocalStorage:!0,shouldLoadStateFromLocalStorage:!0,enablePartialRendering:!0},this.callback={getElementStyle:{},renderElement:{},parseElementData:{},stateIsUpdated:{}},"object"==typeof config)for(var k in config)this.config[k]=config[k];this.updateState=function(elementOrName,valueOrNull){var name,value,element;if("string"==typeof elementOrName)console.log("=> update state by name/value",elementOrName,valueOrNull),name=elementOrName,value=valueOrNull,this.state[elementOrName]=valueOrNull;else if("object"==typeof elementOrName&&"string"==typeof elementOrName.nodeName){console.log("=> update state by element",elementOrName);var el=elementOrName,nodeName=el.nodeName,type=el.type;switch("SELECT"==nodeName&&(type="select"),name=el.name,value=el.value,type){case"select":case"text":case"radio":this.state[name]=value;break;case"checkbox":if(this.state[name]||(this.state[name]=[]),el.checked&&value.length>0)this.state[name].indexOf(value)<0&&this.state[name].push(value);else{var pos=this.state[name].indexOf(value);pos>=0&&this.state[name].splice(pos,1)}break;default:this.state[name]=value}}this.store(),this.stateIsUpdated({name:name,value:value,element:element,state:this.state})},this.stateIsUpdated=function(data){if(console.log("state updated: ",data),"function"==typeof this.callback.stateIsUpdated[data.name]){var c=this.callback.stateIsUpdated[data.name];return c(data)}return data},this.htmlTemplate=function(template,data){console.log("replacing template "+template,"with",data);var output=template;for(var n in data){var search=new RegExp(":"+n,"g"),rep=data[n];output=output.replace(search,rep)}return output},this.store=function(){this.config.shouldSaveStateToLocalStorage&&"object"==typeof window.localStorage&&window.localStorage.setItem(this.localStorageKey,JSON.stringify(this.state))},this.load=function(){if(this.config.shouldLoadStateFromLocalStorage&&"object"==typeof window.localStorage){var d=window.localStorage.getItem(this.localStorageKey);if(!d)return;try{this.state=JSON.parse(d)}catch(e){console.log("Unable to parse state "+d,e)}}},this.elements={data:{main:{},sub:{}},template:{main:{"default":""},sub:{}}},this.getElementStyle=function(elName,state,data){if("function"==typeof this.callback.getElementStyle[elName]){var c=this.callback.getElementStyle[elName];return c(state,data)}if(state){var s=JSON.stringify(state),v=JSON.stringify(data.value);return console.log("=> Element Style: compare state: "+s+" with value: "+v),s.indexOf(v)>=0?"selected":"default"}return"default"},this.parseElementData=function(elName,state,data){if("function"==typeof this.callback.parseElementData[elName]){var c=this.callback.parseElementData[elName];return c(state,data)}return data},this.style="default",this.render=function(){if(this.willRender(),console.log("=> Rendering Main Template"),!this.container)throw new Error("Invalid container specified");var s=this.style,t=this.elements.template.main[s],d=this.elements.data.main;if(!t)throw new Error("Invalid master template for style: "+s);for(var n in this.elements.template.sub)d[n]=this.renderElement(n);this.container.innerHTML=this.htmlTemplate(t,d),this.didRender()},this.renderElement=function(elName){if("object"!=typeof this.elements.template.sub[elName])return console.log("[Warning] No element template found - return empty string"),"";var data=this.elements.data.sub[elName]||{},state=this.state[elName]||"";if(console.log("=> Rendering "+elName+" with state: ",JSON.stringify(state)),"function"==typeof this.callback.renderElement[elName]){var c=this.callback.renderElement[elName];return c(state,data)}var output="",self=this;return data.map(function(item){var d=JSON.parse(JSON.stringify(item)),s=self.getElementStyle(elName,state,d),t=self.elements.template.sub[elName][s],data=self.parseElementData(elName,state,d);data.__call=prefix+".updateState",data.name=elName,data.value||(data.value=state?state:""),console.log("=> Data",data),t||(t=self.elements.template.sub[elName]["default"]),output+=self.htmlTemplate(t,data)}),output},this.init=function(container,autoRender){container&&(this.container=container),this.load(),autoRender!==!1&&(this.appStart(),this.render(),this.appFinish())},this.appStart=function(){},this.appFinish=function(){},this.willRender=function(){},this.didRender=function(){},this.toQuerystring=function(){var qs=[];for(var n in this.state){var v=this.state[n];v&&qs.push(n+"="+v)}return qs.join("&")}};global.SimpleApp=app,"undefined"!=typeof exports&&(exports.SimpleApp=app)}(this),function(global){"use strict";global.SimpleAppManager={apps:{},create:function(name,config){var app=null;return"object"==typeof this.apps[name]?(console.log("App "+name+" is in memory, use it now"),app=this.apps[name]):(app=new SimpleApp(name,config),this.apps[name]=app),app},getAppByName:function(name){return this.apps[name]||new SimpleApp(name)}},"undefined"!=typeof exports&&(exports.SimpleAppManager=global.SimpleAppManager)}(this);