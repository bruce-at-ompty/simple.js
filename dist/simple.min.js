!function(t){"use strict"
t.SimpleAppStart="sta",t.SimpleAppFinish="fin",t.SimpleAppWillRender="wrd",t.SimpleAppDidRender="drd",t.SimpleAppGetElementStyle="ges",t.SimpleAppRenderElement="rde",t.SimpleAppParseElementData="ped",t.SimpleAppStateIsUpdated="siu",String.prototype.hashCode=function(){var t,e,i,a=0
if(0===this.length)return a
for(t=0,i=this.length;i>t;t++)e=this.charCodeAt(t),a=(a<<5)-a+e,a|=0
return Math.abs(a)}
var e=function(t){return JSON.stringify(t)},i=function(t){return JSON.parse(JSON.stringify(t))},a=function(a,s){a=e(a).hashCode()
var n="_sj_"+a
if(this.name=a,t[n]=this,this.localStorageKey=n+"_data",this.container=null,this.state={},this.pState={},this.cnf={localStorageWrite:!0,localStorageRead:!0,partialRender:!0},"object"==typeof s)for(var r in s)this.cnf[r]=s[r]
this.callbacks={sta:{},fin:{},wrd:{},drd:{},ges:{},rde:{},ped:{},siu:{}},this.gc=function(t,e){return e?"function"==typeof this.callbacks[t][e]?this.callbacks[t][e]:void 0:this.callbacks[t]},this.on=function(t,e,i){"object"==typeof this.callbacks[t]&&"function"==typeof i&&(this.callbacks[t][e]=i)},this._f=function(t){var e=this.gc(t)
if("object"==typeof e)for(var i in e){var a=e[i]
"function"==typeof a&&a()}},this.updateState=function(t,e){var i,a,s
if("string"==typeof t)i=t,a=e,this.state[t]=e
else if("object"==typeof t&&"string"==typeof t.nodeName){s=t
var n=s.nodeName,r=s.type
switch("SELECT"==n&&(r="select"),i=s.name,a=s.value,r){case"select":case"text":case"radio":this.state[i]=a
break
case"checkbox":if(this.state[i]||(this.state[i]=[]),s.checked&&a.length>0)this.state[i].indexOf(a)<0&&this.state[i].push(a)
else{var l=this.state[i].indexOf(a)
l>=0&&this.state[i].splice(l,1)}break
default:this.state[i]=a}}this.store(),this.stateIsUpdated({name:i,value:a,element:s,state:this.state})},this.stateIsUpdated=function(t){var e
return(e=this.gc("siu",t.name))?e(t):t},this.htmlTemplate=function(t,e){try{var i=t
for(var a in e)if(a.length>0){var s=new RegExp("{"+a+"}","g"),n=e[a]
i=i.replace(s,n)}return i}catch(r){return""}},this.store=function(){this.cnf.localStorageWrite&&"object"==typeof window.localStorage&&window.localStorage.setItem(this.localStorageKey,e(this.state))},this.load=function(){if(this.cnf.localStorageRead&&"object"==typeof window.localStorage){var t=window.localStorage.getItem(this.localStorageKey)
if(!t)return
try{this.state=JSON.parse(t)}catch(e){}}},this.template={main:{},sub:{}},this.data={},this.pData={},this.cache={},this.getElementStyle=function(t,i,a){var s
if(s=this.gc("ges",t))return s(i,a)
if(i){var n=e(i),r=e(a.value)
return n.indexOf(r)>=0?"selected":"default"}return"default"},this.eId=function(t){return n+"_el_"+t},this.parseElementData=function(t,i,a,s,r){a||(a={})
var l
if(l=this.gc("ped",t))return l(i,a)
var h=["accesskey","name","class","dir","id","lang","style","tabindex","title","src","type","placeholder","selected","checked","readonly","disabled","target","media","href","value"],o={},c=[]
a.name=t,r>0?"select"!=s&&(a.id||(a.id=this.eId(t+"_"+r))):a.id||(a.id=this.eId(t))
var p=n+".updateState(this)"
if(!r)switch(s){case"select":a.onchange=p
break
case"input":a.onkeyup=p,a.value||(a.value=i)
break
default:s&&(a.onclick=p)}r>0&&e(i).indexOf(e(a.value))>=0&&(("select"==s||"radio"==s)&&(a.selected="selected"),"checkbox"==s&&(a.checked="checked"))
for(var d in a)o[d]=a[d],(h.indexOf(d)>=0||d.indexOf("data-")>=0||d.indexOf("on")>=0)&&c.push(d+'="'+a[d]+'"')
return o.attr=c.join(" "),o},this.node=function(t){return document.getElementById(this.eId(t))},this.style="default",this.h2n=function(t,e){var i=e.parentElement
if(i){var a=i.cloneNode()
a.innerHTML=t,i.replaceChild(a.firstChild,e)}},this.render=function(){if(this._f("wrd"),!this.container)throw new Error("Invalid container specified")
var t=this.style,a=this.template.main[t],s=this.cache
if(!a)throw new Error("Invalid master template for style: "+t)
var n=!1
for(var r in this.template.sub)if(this.cnf.partialRender&&e(this.state[r])==e(this.pState[r])&&"string"==typeof s[r]&&e(this.data[r])==e(this.pData[r]));else{var l=this.renderElement(r),h=this.node(r)
h?"string"==typeof l&&l.length>0&&this.h2n(l,h):"string"==typeof l&&l.length>0&&(s[r]=l,n=!0)}this.pState=i(this.state),this.pData=i(this.data),n&&(this.container.innerHTML=this.htmlTemplate(a,s),this._f("drd"))},this.renderElement=function(t){if("object"!=typeof this.template.sub[t])return""
var a,s=this.data[t]||{},n=this.state[t]||"",r=""
if(a=this.gc("rde",t))return a(n,s)
var l=this.template.sub[t],h=(l._type,this)
if(l._wrapper){s.wrapper||(s.wrapper={})
var o=this.parseElementData(t,n,s.wrapper,l._type),c=s.element||[],p=0
c.map(function(a){p++
var s=i(a),o=h.getElementStyle(t,n,s),c=h.template.sub[t][o],d=h.parseElementData(t,n,s,l._type,p)
c||(c=h.template.sub[t]["default"])
var f=h.node(t+"_"+p),u=h.htmlTemplate(c,d)
if(f&&h.cnf.partialRender){var m=p-1,v=e(h.pData[t].element[m]),g=e(h.data[t].element[m])
v!=g&&h.h2n(u,f)}else r+=u}),"string"==typeof r&&r.length>1&&(r=h.htmlTemplate(l._wrapper[0],o)+r+l._wrapper[1])}else{var d=this.getElementStyle(t,n,s),f=this.template.sub[t][d],u=this.parseElementData(t,n,s,l._type)
f||(f=this.template.sub[t]["default"]),r+=this.htmlTemplate(f,u)}return r},this.init=function(t,e){t&&(this.container=t),this.load(),e!==!1&&(this._f("sta"),this.render(),this._f("fin"))},this.toQuerystring=function(){var t=[]
for(var e in this.state){var i=this.state[e]
i&&t.push(e+"="+i)}return t.join("&")}},s={}
t.SimpleApp=function(t,e){return s[t]||(s[t]=new a(t,e)),s[t]},"undefined"!=typeof exports&&(exports.SimpleApp=t.SimpleApp,exports.SimpleEvent=t.SimpleEvent)}(this)
